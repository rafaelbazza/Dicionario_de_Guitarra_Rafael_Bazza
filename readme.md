Expandindo as funções e tentando refatorar para não repetir tanto código. 

